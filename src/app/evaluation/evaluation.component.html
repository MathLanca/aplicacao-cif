<div *ngIf="!loaded" class="spinner" fxLayoutAlign="center">
    <mat-spinner></mat-spinner>
</div>
<mat-horizontal-stepper *ngIf="loaded" class="main-stepper" linear="true" #stepper>
    <mat-step fxLayoutAlign="center" [stepControl]="ieFormGroup">
        <form [formGroup]="ieFormGroup" autocomplete="off">
            <ng-template matStepLabel>
                <span matTooltip="{{stepOne}}">{{stepOne}}</span>
            </ng-template>

            <h3 matTooltip="{{stepOne}}">{{stepOne}}</h3>

            <mat-card>
                <mat-form-field>
                    <mat-label>Paciente</mat-label>
                    <mat-select formControlName="patientId">
                        <mat-option *ngFor="let patient of patients" [value]="patient.id">
                            {{ patient.firstName }} {{ patient.lastName }}
                        </mat-option>
                        <mat-option (click)="redirectToPatientRegister()">
                            + Novo Paciente
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <mat-form-field>
                    <mat-label>Local da Classificação</mat-label>
                    <input matInput placeholder="Local da Classificação" formControlName="location" required>
                </mat-form-field>

                <div class="nextStep">
                    <button mat-button (click)="goBack2Home()" mat-stroked-button color="warn" class="float-left">
                        Cancelar
                    </button>
                    <span class="spacer"></span>
                    <button mat-button matStepperNext [disabled]="!ieFormGroup.valid" mat-stroked-button
                        (click)="addIEtoBounderObject()" color="warn" class="float-right">
                        Próximo
                    </button>
                </div>
            </mat-card>
        </form>
    </mat-step>
    <mat-step [stepControl]="bfFormGroup">
        <form [formGroup]="bfFormGroup">
            <ng-template matStepLabel>
                <span matTooltip="{{stepFive}}">{{stepFive}}</span>
            </ng-template>

            <mat-card class="session-description">
                <mat-card-title>
                    <p>{{stepFive}}
                    </p>
                </mat-card-title>
                <mat-card-subtitle>
                    <p>Funções fisiológicas dos sistema corporais (incluindo as funções psicológicas)</p>
                    <p class="bold-font">Quanto prejuízo a pessoa tem em ...</p>
                    <p class="bold-font">Onde:</p>
                    <p>0 - Nenhuma deficiência | 1 - Deficiência leve | 2 - Deficiência moderada | 3 - Deficiência grave | 4 -
                        Deficiência completa | 8 - Não especificado | 9 - Não aplicável </p>
                </mat-card-subtitle>
            </mat-card>

            <mat-accordion>
                <mat-expansion-panel #functionPanel *ngFor="let function of bodyFunctions">
                    <mat-expansion-panel-header *ngIf="!functionPanel.expanded">
                        <mat-panel-title *ngIf="!functionPanel.expanded">
                            {{ function.code }}
                        </mat-panel-title>
                        <mat-panel-description *ngIf="!functionPanel.expanded">
                            {{ function.title }}
                        </mat-panel-description>
                    </mat-expansion-panel-header>

                    <p>{{ function.code }} - <span class="inner-title">{{ function.title }}</span></p>


                    <mat-divider></mat-divider>

                    <p class="bold-font">{{ function.description }}</p>
                    <p *ngIf="function.inclusion != null"><span class="bold-font">Inclusões:
                        </span>{{ function.inclusion }}</p>
                    <p *ngIf="function.exclusion != null"><span class="bold-font">Exclusões:
                        </span>{{ function.exclusion }}</p>

                    <mat-divider></mat-divider>

                    <div class="general-grade" fxLayoutAlign="end" formArrayName="generalGrade">
                        <span class="bold-font grade grade-radio">Geral</span>
                        <mat-radio-group [formControlName]="bodyFunctions.indexOf(function)" class="grade-radio"
                            aria-label="Select an option">
                            <mat-radio-button color="warn" value="0" matTooltip="Nenhuma deficiência"
                                matTooltipPosition="above">0</mat-radio-button>
                            <mat-radio-button color="warn" value="1" matTooltip="Deficiência leve"
                                matTooltipPosition="above">1</mat-radio-button>
                            <mat-radio-button color="warn" value="2" matTooltip="Deficiência moderada"
                                matTooltipPosition="above">2</mat-radio-button>
                            <mat-radio-button color="warn" value="3" matTooltip="Deficiência grave"
                                matTooltipPosition="above">3</mat-radio-button>
                            <mat-radio-button color="warn" value="4" matTooltip="Deficiência completa"
                                matTooltipPosition="above">4</mat-radio-button>
                            <mat-radio-button color="warn" value="8" matTooltip="Não especificado"
                                matTooltipPosition="above">8</mat-radio-button>
                            <mat-radio-button color="warn" value="9" matTooltip="Não aplicável"
                                matTooltipPosition="above">9</mat-radio-button>
                        </mat-radio-group>

                        <mat-form-field class="grade-select">
                            <mat-label>
                                Geral
                            </mat-label>
                            <mat-select [formControlName]="bodyFunctions.indexOf(function)" class="grade-select">
                                <mat-option value="0">0 - Nenhuma deficiência</mat-option>
                                <mat-option value="1">1 - Deficiência leve</mat-option>
                                <mat-option value="2">2 - Deficiência moderada</mat-option>
                                <mat-option value="3">3 - Deficiência grave</mat-option>
                                <mat-option value="4">4 - Deficiência completa</mat-option>
                                <mat-option value="8">8 - Não especificado</mat-option>
                                <mat-option value="9">9 - Não aplicável</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <div fxLayoutAlign="start" class="general-grade" formArrayName="infoSource">
                        <span class="bold-font grade grade-radio">Fonte da informação</span>
                        <mat-radio-group [formControlName]="bodyFunctions.indexOf(function)" class="grade-radio"
                            aria-label="Select an option">
                            <mat-radio-button color="warn" value="Anamnese">Anamnese</mat-radio-button>
                            <mat-radio-button color="warn" value="Questionário relatado pelo paciente">Questionário
                                relatado pelo paciente</mat-radio-button>
                            <mat-radio-button color="warn" value="Exame clínico">Exame clínico</mat-radio-button>
                            <mat-radio-button color="warn" value="Investigação técnica">Investigação técnica
                            </mat-radio-button>
                        </mat-radio-group>

                        <mat-form-field class="grade-select">
                            <mat-label>
                                Fonte da informação
                            </mat-label>
                            <mat-select [formControlName]="bodyFunctions.indexOf(function)" class="grade-select">
                                <mat-option color="warn" value="Anamnese">Anamnese</mat-option>
                                <mat-option color="warn" value="Questionário relatado pelo paciente">Questionário
                                    relatado pelo paciente</mat-option>
                                <mat-option color="warn" value="Exame clínico">Exame clínico</mat-option>
                                <mat-option color="warn" value="Investigação técnica">Investigação técnica</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <mat-form-field class="textarea" appearance="fill" formArrayName="problemDescription">
                        <mat-label>Descrição do Problema (Opcional)</mat-label>
                        <textarea matInput cols="100000" [formControlName]="bodyFunctions.indexOf(function)"
                            placeholder="Descrição do Problema"></textarea>
                    </mat-form-field>

                </mat-expansion-panel>
            </mat-accordion>
            <span #invalid fxLayoutAlign="center" *ngIf="invalids.length > 0" class="invalid">*As questões: {{invalids}}
                devem ser respondidas</span>
            <div class="nextStep">
                <button mat-button mat-button matStepperPrevious mat-stroked-button color="warn"
                    class="btn-block btn-cancel">
                    Anterior
                </button>
                <span class="spacer"></span>
                <button mat-button mat-stroked-button [matTooltip]="invalids"
                    (click)="validateForm(bfFormGroup,bodyFunctions)" matTooltipPosition="before"
                    *ngIf="!bfFormGroup.valid" color="warn" class="btn-block btn-next">
                    Próximo
                </button>
                <button mat-button matStepperNext mat-stroked-button (click)="addAnswers(bfFormGroup)"
                    *ngIf="bfFormGroup.valid" color="warn" class="btn-block btn-next">
                    Próximo
                </button>
            </div>
        </form>
    </mat-step>
    <mat-step [stepControl]="bsFormGroup">
        <form [formGroup]="bsFormGroup">
            <ng-template matStepLabel>
                <span matTooltip="{{stepFour}}">{{stepFour}}</span>
            </ng-template>

            <mat-card class="session-description">
                <mat-card-title>
                    <p>{{stepFour}}
                    </p>
                </mat-card-title>
                <mat-card-subtitle>
                    <p>As estruturas corporais são partes anatômicas do corpo, como os órgãos, membros e seus componentes.
                    </p>
                    <p>As deficiências são problemas nas funções ou estruturas do corpo como um desvio ou perda significativa.</p>
                    <p class="bold-font">Onde:</p>
                    <p>Extensão | 0 - Nenhuma deficiência | 1 - Deficiência leve | 2 - Deficiência moderada | 3 -
                        Deficiência grave | 4 - Deficiência completa | 8 - Não especificada | 9 - Não aplicável </p>
                    <p>Natureza | 0 - Nenhuma mudança na estrutura | 1 - Ausência total | 2 - Ausência parcial | 3 -
                        Parte adicional | 4 - Dimensões aberrantes | 5 - Descontinuidade | 6 - Desvio de posição | 7 -
                        Mudanças qualitativas na estrutura, incluindo acúmulo de fluído | 8 - Não especificada | 9 - Não
                        aplicável </p>
                    <p>Localização | 0 - Mais de uma região | 1 - Direita | 2 - Esquerda | 3 - Ambos os lados | 4 -
                        Parte anterior | 5 - Parte posterior | 6 - Proximal | 7 - Distal | 8 - Não especificada | 9 -
                        Não aplicável </p>
                </mat-card-subtitle>
            </mat-card>

            <mat-accordion>
                <mat-expansion-panel #structurePanel *ngFor="let structure of bodyStructures">
                    <mat-expansion-panel-header *ngIf="!structurePanel.expanded">
                        <mat-panel-title *ngIf="!structurePanel.expanded">
                            {{ structure.code}}
                        </mat-panel-title>
                        <mat-panel-description *ngIf="!structurePanel.expanded">
                            {{structure.title }}
                        </mat-panel-description>
                    </mat-expansion-panel-header>

                    <p>{{ structure.code }} - <span class="inner-title">{{ structure.title }}</span></p>

                    <mat-divider></mat-divider>

                    <p *ngIf="structure.description != null" class="bold-font">{{ structure.description }}</p>
                    <p *ngIf="structure.inclusion != null"><span class="bold-font">Inclusões:
                        </span>{{ structure.inclusion }}</p>
                    <p *ngIf="structure.exclusion != null"><span class="bold-font">Exclusões:
                        </span>{{ structure.exclusion }}</p>

                    <mat-divider></mat-divider>
                    <div class="general-grade" fxLayoutAlign="end" formArrayName="extensionGrade">
                        <span class="bold-font grade grade-radio">Extensão</span>
                        <mat-radio-group [formControlName]="bodyStructures.indexOf(structure)" class="grade-radio"
                            aria-label="Select an option">
                            <mat-radio-button color="warn" value="0" matTooltip="Nenhuma deficiência"
                                matTooltipPosition="above">0</mat-radio-button>
                            <mat-radio-button color="warn" value="1" matTooltip="Deficiência leve"
                                matTooltipPosition="above">1</mat-radio-button>
                            <mat-radio-button color="warn" value="2" matTooltip="Deficiência moderada"
                                matTooltipPosition="above">2</mat-radio-button>
                            <mat-radio-button color="warn" value="3" matTooltip="Deficiência grave"
                                matTooltipPosition="above">3</mat-radio-button>
                            <mat-radio-button color="warn" value="4" matTooltip="Deficiência completa"
                                matTooltipPosition="above">4</mat-radio-button>
                            <mat-radio-button color="warn" value="8" matTooltip="Não especificada"
                                matTooltipPosition="above">8</mat-radio-button>
                            <mat-radio-button color="warn" value="9" matTooltip="Não aplicável"
                                matTooltipPosition="above">9</mat-radio-button>
                        </mat-radio-group>

                        <mat-form-field class="grade-select">
                            <mat-label>
                                Extensão
                            </mat-label>
                            <mat-select [formControlName]="bodyStructures.indexOf(structure)" class="grade-select">
                                <mat-option value="0">0 - Nenhuma deficiência</mat-option>
                                <mat-option value="1">1 - Deficiência leve</mat-option>
                                <mat-option value="2">2 - Deficiência moderada</mat-option>
                                <mat-option value="3">3 - Deficiência grave</mat-option>
                                <mat-option value="4">4 - Deficiência completa</mat-option>
                                <mat-option value="8">8 - Não especificada</mat-option>
                                <mat-option value="9">9 - Não aplicável</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>


                    <div class="general-grade" fxLayoutAlign="end" formArrayName="natureGrade">
                        <span class="bold-font grade grade-radio">Natureza</span>
                        <mat-radio-group [formControlName]="bodyStructures.indexOf(structure)" class="grade-radio"
                            aria-label="Select an option">
                            <mat-radio-button color="warn" value="0" matTooltip="Nenhuma mudança na estrutura"
                                matTooltipPosition="above">0</mat-radio-button>
                            <mat-radio-button color="warn" value="1" matTooltip="Ausência total"
                                matTooltipPosition="above">1</mat-radio-button>
                            <mat-radio-button color="warn" value="2" matTooltip="Ausência parcial"
                                matTooltipPosition="above">2</mat-radio-button>
                            <mat-radio-button color="warn" value="3" matTooltip="Parte adicional"
                                matTooltipPosition="above">3</mat-radio-button>
                            <mat-radio-button color="warn" value="4" matTooltip="Dimensões aberrantes"
                                matTooltipPosition="above">4</mat-radio-button>
                            <mat-radio-button color="warn" value="5" matTooltip="Descontinuidade"
                                matTooltipPosition="above">5</mat-radio-button>
                            <mat-radio-button color="warn" value="6" matTooltip="Posição desviada"
                                matTooltipPosition="above">6</mat-radio-button>
                            <mat-radio-button color="warn" value="7"
                                matTooltip="Mudanças qualitativas na estrutura, incluindo acúmulo de fluído"
                                matTooltipPosition="above">7</mat-radio-button>
                            <mat-radio-button color="warn" value="8" matTooltip="Não especificado"
                                matTooltipPosition="above">8</mat-radio-button>
                            <mat-radio-button color="warn" value="9" matTooltip="Não aplicável"
                                matTooltipPosition="above">9</mat-radio-button>
                        </mat-radio-group>

                        <mat-form-field class="grade-select">
                            <mat-label>
                                Natureza
                            </mat-label>
                            <mat-select [formControlName]="bodyStructures.indexOf(structure)" class="grade-select">
                                <mat-option value="0">0 - Nenhuma mudança na estrutura</mat-option>
                                <mat-option value="1">1 - Ausência total</mat-option>
                                <mat-option value="2">2 - Ausência parcial</mat-option>
                                <mat-option value="3">3 - Parte adicional</mat-option>
                                <mat-option value="4">4 - Dimensões aberrantes</mat-option>
                                <mat-option value="5">5 - Dimensões aberrantes</mat-option>
                                <mat-option value="6">6 - Descontinuidade</mat-option>
                                <mat-option value="7">7 - Mudanças qualitativas na estrutura, incluindo acúmulo de
                                    fluído</mat-option>
                                <mat-option value="8">8 - Não especificado</mat-option>
                                <mat-option value="9">9 - Não aplicável</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <div class="general-grade" fxLayoutAlign="end" formArrayName="locationGrade">
                        <span class="bold-font grade grade-radio">Localização</span>
                        <mat-radio-group [formControlName]="bodyStructures.indexOf(structure)" class="grade-radio"
                            aria-label="Select an option">
                            <mat-radio-button color="warn" value="0" matTooltip="Mais de uma região"
                                matTooltipPosition="above">0</mat-radio-button>
                            <mat-radio-button color="warn" value="1" matTooltip="Direita" matTooltipPosition="above">1
                            </mat-radio-button>
                            <mat-radio-button color="warn" value="2" matTooltip="Esquerda" matTooltipPosition="above">2
                            </mat-radio-button>
                            <mat-radio-button color="warn" value="3" matTooltip="Ambos os lados"
                                matTooltipPosition="above">3</mat-radio-button>
                            <mat-radio-button color="warn" value="4" matTooltip="Parte dianteira"
                                matTooltipPosition="above">4</mat-radio-button>
                            <mat-radio-button color="warn" value="5" matTooltip="Parte traseira"
                                matTooltipPosition="above">5</mat-radio-button>
                            <mat-radio-button color="warn" value="6" matTooltip="Proximal" matTooltipPosition="above">6
                            </mat-radio-button>
                            <mat-radio-button color="warn" value="7" matTooltip="Distal" matTooltipPosition="above">7
                            </mat-radio-button>
                            <mat-radio-button color="warn" value="8" matTooltip="Não especificada"
                                matTooltipPosition="above">8</mat-radio-button>
                            <mat-radio-button color="warn" value="9" matTooltip="Não aplicável"
                                matTooltipPosition="above">9</mat-radio-button>
                        </mat-radio-group>

                        <mat-form-field class="grade-select">
                            <mat-label>
                                Localização
                            </mat-label>
                            <mat-select [formControlName]="bodyStructures.indexOf(structure)" class="grade-select">
                                <mat-option value="0">0 - Mais de uma região</mat-option>
                                <mat-option value="1">1 - Direita</mat-option>
                                <mat-option value="2">2 - Esquerda</mat-option>
                                <mat-option value="3">3 - Ambos os lados</mat-option>
                                <mat-option value="4">4 - Parte dianteira</mat-option>
                                <mat-option value="5">5 - Parte traseira</mat-option>
                                <mat-option value="6">6 - Proximal</mat-option>
                                <mat-option value="7">7 - Distal</mat-option>
                                <mat-option value="8">8 - Não especificada</mat-option>
                                <mat-option value="9">9 - Não aplicável</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <div fxLayoutAlign="start" class="general-grade" formArrayName="infoSource">
                        <span class="bold-font grade grade-radio">Fonte da informação</span>
                        <mat-radio-group [formControlName]="bodyStructures.indexOf(structure)" class="grade-radio"
                            aria-label="Select an option">
                            <mat-radio-button color="warn" value="Anamnese">Anamnese</mat-radio-button>
                            <mat-radio-button color="warn" value="Questionário relatado pelo paciente">Questionário
                                relatado pelo paciente</mat-radio-button>
                            <mat-radio-button color="warn" value="Exame clínico">Exame clínico</mat-radio-button>
                            <mat-radio-button color="warn" value="Investigação técnica">Investigação técnica
                            </mat-radio-button>
                        </mat-radio-group>

                        <mat-form-field class="grade-select">
                            <mat-label>
                                Fonte da informação
                            </mat-label>
                            <mat-select [formControlName]="bodyStructures.indexOf(structure)" class="grade-select">
                                <mat-option color="warn" value="Anamnese">Anamnese</mat-option>
                                <mat-option color="warn" value="Questionário relatado pelo paciente">Questionário
                                    relatado pelo paciente</mat-option>
                                <mat-option color="warn" value="Exame clínico">Exame clínico</mat-option>
                                <mat-option color="warn" value="Investigação técnica">Investigação técnica</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <mat-form-field class="textarea" appearance="fill" formArrayName="problemDescription">
                        <mat-label>Descrição do Problema (Opcional)</mat-label>
                        <textarea matInput cols="100000" [formControlName]="bodyStructures.indexOf(structure)"
                            placeholder="Descrição do Problema"></textarea>
                    </mat-form-field>
                </mat-expansion-panel>
            </mat-accordion>
            <span #invalid fxLayoutAlign="center" *ngIf="invalids.length > 0" class="invalid">*As questões: {{invalids}}
                devem ser respondidas</span>
            <div class="nextStep">
                <button mat-button mat-button matStepperPrevious mat-stroked-button color="warn"
                    class="btn-block btn-cancel">
                    Anterior
                </button>
                <span class="spacer"></span>
                <button mat-button mat-stroked-button [matTooltip]="invalids"
                    (click)="validateForm(bsFormGroup,bodyStructures)" matTooltipPosition="before"
                    *ngIf="!bsFormGroup.valid" color="warn" class="btn-block btn-next">
                    Próximo
                </button>
                <button mat-button matStepperNext mat-stroked-button (click)="addAnswers(bsFormGroup)"
                    *ngIf="bsFormGroup.valid" color="warn" class="btn-block btn-next">
                    Próximo
                </button>
            </div>
        </form>
    </mat-step>
    <mat-step [stepControl]="apFormGroup">
        <form [formGroup]="apFormGroup">
            <ng-template matStepLabel>
                <span matTooltip="{{stepThree}}">{{stepThree}}</span>
            </ng-template>

            <mat-card class="session-description">
                <mat-card-title>
                    <p>{{stepThree}}
                    </p>
                </mat-card-title>
                <mat-card-subtitle>
                    <p>Atividade é a execução de uma tarefa ou ação por um indivíduo.</p>
                    <p>Participação é o ato de se envolver em uma situação vital.</p>
                    <p>Limitação da atividade são dificuldades que o indivíduo pode ter para executar uma atividade.</p>
                    <p>Restrições de participação são problemas que um indivíduo pode enfrentar ao se envolver em situações vitais.</p>
                    <p class="bold-font">Quanto prejuízo a pessoa tem em ...</p>
                    <p>P = DESEMPENHO EM ...</p>
                    <p>C = CAPACIDADE DE ...</p>

                    <p class="bold-font">Onde:</p>
                    <p>XXX.0 NENHUMA dificuldade (nenhuma, ausente ou escassa, ...) 0 - 4%</p>
                    <p>XXX.1 Dificuldade LEVE (ligeira, baixa, ....) 5 – 24 %</p>
                    <p>XXX.2 Dificuldade MODERADA (média, regular, ...) 25 – 49 %</p>
                    <p>XXX.3 Dificuldade GRAVE (alta, extrema, ...) 50 – 95%</p>
                    <p>XXX.4 Dificuldade COMPLETA (total, ...) 96 – 100%</p>
                    <p>XXX.8 Não especificada</p>
                    <p>XXX.9 Não aplicável</p>
                </mat-card-subtitle>
            </mat-card>

            <mat-accordion>
                <mat-expansion-panel #aNpPanel *ngFor="let aNp of activityAndParticipation">
                    <mat-expansion-panel-header *ngIf="!aNpPanel.expanded">
                        <mat-panel-title *ngIf="!aNpPanel.expanded">
                            {{ aNp.code}}
                        </mat-panel-title>
                        <mat-panel-description *ngIf="!aNpPanel.expanded">
                            {{aNp.title }}
                        </mat-panel-description>
                    </mat-expansion-panel-header>

                    <p>{{ aNp.code }} - <span class="inner-title">{{ aNp.title }}</span></p>

                    <mat-divider></mat-divider>

                    <p class="bold-font">{{ aNp.description }}</p>
                    <p *ngIf="aNp.inclusion != null"><span class="bold-font">Inclusões: </span>{{ aNp.inclusion }}</p>
                    <p *ngIf="aNp.exclusion != null"><span class="bold-font">Exclusões: </span>{{ aNp.exclusion }}</p>

                    <mat-divider></mat-divider>

                    <div class="general-grade" fxLayoutAlign="end" formArrayName="capacityGrade">
                        <span class="bold-font grade grade-radio">C</span>
                        <mat-radio-group [formControlName]="activityAndParticipation.indexOf(aNp)" class="grade-radio"
                            aria-label="Select an option">
                            <mat-radio-button color="warn" value="0" matTooltip="NENHUMA dificuldade "
                                matTooltipPosition="above">0</mat-radio-button>
                            <mat-radio-button color="warn" value="1" matTooltip="Dificuldade LEVE"
                                matTooltipPosition="above">1</mat-radio-button>
                            <mat-radio-button color="warn" value="2" matTooltip="Dificuldade MODERADA"
                                matTooltipPosition="above">2</mat-radio-button>
                            <mat-radio-button color="warn" value="3" matTooltip="Dificuldade GRAVE"
                                matTooltipPosition="above">3</mat-radio-button>
                            <mat-radio-button color="warn" value="4" matTooltip="Dificuldade COMPLETA"
                                matTooltipPosition="above">4</mat-radio-button>
                            <mat-radio-button color="warn" value="8" matTooltip="Não especificada"
                                matTooltipPosition="above">8</mat-radio-button>
                            <mat-radio-button color="warn" value="9" matTooltip="Não aplicável"
                                matTooltipPosition="above">9</mat-radio-button>
                        </mat-radio-group>

                        <mat-form-field class="grade-select">
                            <mat-label>
                                C
                            </mat-label>
                            <mat-select [formControlName]="activityAndParticipation.indexOf(aNp)" class="grade-select">
                                <mat-option value="0">0 - NENHUMA dificuldade</mat-option>
                                <mat-option value="1">1 - Dificuldade LEVE</mat-option>
                                <mat-option value="2">2 - Dificuldade MODERADA</mat-option>
                                <mat-option value="3">3 - Dificuldade GRAVE</mat-option>
                                <mat-option value="4">4 - Dificuldade COMPLETA</mat-option>
                                <mat-option value="8">8 - Não especificada</mat-option>
                                <mat-option value="9">9 - Não aplicável</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div class="general-grade" fxLayoutAlign="end" formArrayName="performanceGrade">
                        <span class="bold-font grade grade-radio">P</span>
                        <mat-radio-group [formControlName]="activityAndParticipation.indexOf(aNp)" class="grade-radio"
                            aria-label="Select an option">
                            <mat-radio-button color="warn" value="0" matTooltip="NENHUMA dificuldade "
                                matTooltipPosition="above">0</mat-radio-button>
                            <mat-radio-button color="warn" value="1" matTooltip="Dificuldade LEVE"
                                matTooltipPosition="above">1</mat-radio-button>
                            <mat-radio-button color="warn" value="2" matTooltip="Dificuldade MODERADA"
                                matTooltipPosition="above">2</mat-radio-button>
                            <mat-radio-button color="warn" value="3" matTooltip="Dificuldade GRAVE"
                                matTooltipPosition="above">3</mat-radio-button>
                            <mat-radio-button color="warn" value="4" matTooltip="Dificuldade COMPLETA"
                                matTooltipPosition="above">4</mat-radio-button>
                            <mat-radio-button color="warn" value="8" matTooltip="Não especificada"
                                matTooltipPosition="above">8</mat-radio-button>
                            <mat-radio-button color="warn" value="9" matTooltip="Não aplicável"
                                matTooltipPosition="above">9</mat-radio-button>
                        </mat-radio-group>

                        <mat-form-field class="grade-select">
                            <mat-label>
                                P
                            </mat-label>
                            <mat-select [formControlName]="activityAndParticipation.indexOf(aNp)" class="grade-select">
                                <mat-option value="0">0 - NENHUMA dificuldade</mat-option>
                                <mat-option value="1">1 - Dificuldade LEVE</mat-option>
                                <mat-option value="2">2 - Dificuldade MODERADA</mat-option>
                                <mat-option value="3">3 - Dificuldade GRAVE</mat-option>
                                <mat-option value="4">4 - Dificuldade COMPLETA</mat-option>
                                <mat-option value="8">8 - Não especificada</mat-option>
                                <mat-option value="9">9 - Não aplicável</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <div fxLayoutAlign="start" class="general-grade" formArrayName="infoSource">
                        <span class="bold-font grade grade-radio">Fonte da informação</span>
                        <mat-radio-group [formControlName]="activityAndParticipation.indexOf(aNp)" class="grade-radio"
                            aria-label="Select an option">
                            <mat-radio-button color="warn" value="Anamnese">Anamnese</mat-radio-button>
                            <mat-radio-button color="warn" value="Questionário relatado pelo paciente">Questionário
                                relatado pelo paciente</mat-radio-button>
                            <mat-radio-button color="warn" value="Exame clínico">Exame clínico</mat-radio-button>
                            <mat-radio-button color="warn" value="Investigação técnica">Investigação técnica
                            </mat-radio-button>
                        </mat-radio-group>

                        <mat-form-field class="grade-select">
                            <mat-label>
                                Fonte da informação
                            </mat-label>
                            <mat-select [formControlName]="activityAndParticipation.indexOf(aNp)" class="grade-select">
                                <mat-option color="warn" value="Anamnese">Anamnese</mat-option>
                                <mat-option color="warn" value="Questionário relatado pelo paciente">Questionário
                                    relatado pelo paciente</mat-option>
                                <mat-option color="warn" value="Exame clínico">Exame clínico</mat-option>
                                <mat-option color="warn" value="Investigação técnica">Investigação técnica</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <mat-form-field class="textarea" appearance="fill" formArrayName="problemDescription">
                        <mat-label>Descrição do Problema (Opcional)</mat-label>
                        <textarea matInput cols="100000" [formControlName]="activityAndParticipation.indexOf(aNp)"
                            placeholder="Descrição do Problema"></textarea>
                    </mat-form-field>
                </mat-expansion-panel>
            </mat-accordion>

            <span #invalid fxLayoutAlign="center" *ngIf="invalids.length > 0" class="invalid">*As questões: {{invalids}}
                devem ser respondidas</span>
            <div class="nextStep">
                <button mat-button mat-button matStepperPrevious mat-stroked-button color="warn"
                    class="btn-block btn-cancel">
                    Anterior
                </button>
                <span class="spacer"></span>
                <button mat-button mat-stroked-button [matTooltip]="invalids"
                    (click)="validateForm(apFormGroup,activityAndParticipation)" matTooltipPosition="before"
                    *ngIf="!apFormGroup.valid" color="warn" class="btn-block btn-next">
                    Próximo
                </button>
                <button mat-button matStepperNext mat-stroked-button (click)="addAnswers(apFormGroup)"
                    *ngIf="apFormGroup.valid" color="warn" class="btn-block btn-next">
                    Próximo
                </button>
            </div>
        </form>
    </mat-step>
    <mat-step [stepControl]="efFormGroup">
        <form [formGroup]="efFormGroup">
            <ng-template matStepLabel>
                <span matTooltip="{{stepTwo}}">{{stepTwo}}</span>
            </ng-template>

            <mat-card class="session-description">
                <mat-card-title>
                    <p>{{stepTwo}}
                    </p>
                </mat-card-title>
                <mat-card-subtitle>
                    <p>Constituem o ambiente físico, social e de atitudes em que as pessoas vivem e conduzem sua vida.</p>
                    <p>XXX.0 NENHUMA barreira (nenhuma, ausente ou escassa, ...) 0 - 4%</p>
                    <p>XXX.1 Barreira LEVE (leve, baixa, ....) 5 – 24 %</p>
                    <p>XXX.2 Barreira MODERADA (média, regular, ...) 25 – 49 %</p>
                    <p>XXX.3 Barreira GRAVE (alta, extrema, ...) 50 – 95%</p>
                    <p>XXX.4 Barreira COMPLETA (total, ...) 96 – 100%</p>
                    <p>XXX+0 NENHUM facilitador (nenhum, ausente ou escassa, ...) 0 - 4%</p>
                    <p>XXX+1 Facilitador LEVE (leve, baixo, ...) 5 - 24%</p>
                    <p>XXX+2 Facilitador MODERADO (médio, regular, ...) 25 – 49%</p>
                    <p>XXX+3 Facilitador CONSIDERÁVEL (alto, extremo, ...) 50 - 95%</p>
                    <p>XXX+4 Facilitador COMPLETO (total, ...) 86 – 100%</p>
                    <p>XXX.8 Barreira não especificada</p>
                    <p>XXX+8 Facilitador não especificado</p>
                    <p>XXX.9 Não aplicável</p>
                </mat-card-subtitle>
            </mat-card>

            <mat-accordion>
                <mat-expansion-panel #factorPanel *ngFor="let factor of environmentalFactors">
                    <mat-expansion-panel-header *ngIf="!factorPanel.expanded">
                        <mat-panel-title *ngIf="!factorPanel.expanded">
                            {{ factor.code}}
                        </mat-panel-title>
                        <mat-panel-description *ngIf="!factorPanel.expanded">
                            {{factor.title }}
                        </mat-panel-description>
                    </mat-expansion-panel-header>

                    <p>{{ factor.code }} - <span class="inner-title">{{ factor.title }}</span></p>

                    <mat-divider></mat-divider>

                    <p class="bold-font">{{ factor.description }}</p>
                    <p *ngIf="factor.inclusion != null"><span class="bold-font">Inclusões: </span>{{ factor.inclusion }}
                    </p>
                    <p *ngIf="factor.exclusion != null"><span class="bold-font">Exclusões: </span>{{ factor.exclusion }}
                    </p>

                    <mat-divider></mat-divider>

                    <div class="general-grade" fxLayoutAlign="end" formArrayName="generalGrade">
                        <span class="bold-font grade grade-radio">Geral</span>
                        <mat-radio-group [formControlName]="environmentalFactors.indexOf(factor)" class="grade-radio"
                            aria-label="Select an option">
                            <mat-radio-button color="warn" value="+4" matTooltip="Facilitador COMPLETO"
                                matTooltipPosition="above">+4</mat-radio-button>
                            <mat-radio-button color="warn" value="+3" matTooltip="Facilitador CONSIDERÁVEL"
                                matTooltipPosition="above">+3</mat-radio-button>
                            <mat-radio-button color="warn" value="+2" matTooltip="Facilitador MODERADO"
                                matTooltipPosition="above">+2</mat-radio-button>
                            <mat-radio-button color="warn" value="+1" matTooltip="Facilitador leve"
                                matTooltipPosition="above">+1</mat-radio-button>
                            <mat-radio-button color="warn" value="+0" matTooltip="NENHUM facilitador"
                                matTooltipPosition="above">+0</mat-radio-button>
                            <mat-radio-button color="warn" value="0" matTooltip="NENHUMA barreira"
                                matTooltipPosition="above">0</mat-radio-button>
                            <mat-radio-button color="warn" value="1" matTooltip="Barreira LEVE"
                                matTooltipPosition="above">1</mat-radio-button>
                            <mat-radio-button color="warn" value="2" matTooltip="Barreira MODERADA"
                                matTooltipPosition="above">2</mat-radio-button>
                            <mat-radio-button color="warn" value="3" matTooltip="Barreira GRAVE"
                                matTooltipPosition="above">3</mat-radio-button>
                            <mat-radio-button color="warn" value="4" matTooltip="Barreira COMPLETA"
                                matTooltipPosition="above">4</mat-radio-button>
                            <mat-radio-button color="warn" value="8" matTooltip="Não especificado"
                                matTooltipPosition="above">8</mat-radio-button>
                            <mat-radio-button color="warn" value="+8" matTooltip="Facilitador não especificado"
                                matTooltipPosition="above">+8</mat-radio-button>
                            <mat-radio-button color="warn" value="9" matTooltip="Não aplicável"
                                matTooltipPosition="above">9</mat-radio-button>
                        </mat-radio-group>

                        <mat-form-field class="grade-select">
                            <mat-label>
                                Geral
                            </mat-label>
                            <mat-select [formControlName]="environmentalFactors.indexOf(factor)" class="grade-select">
                                <mat-option value="+4">+4 - Facilitador COMPLETO</mat-option>
                                <mat-option value="+3">+3 - Facilitador CONSIDERÁVEL</mat-option>
                                <mat-option value="+2">+2 - Facilitador MODERADO</mat-option>
                                <mat-option value="+1">+1 - Facilitador leve</mat-option>
                                <mat-option value="+0">+0 - NENHUM facilitador</mat-option>
                                <mat-option value="0">0 - NENHUMA barreira</mat-option>
                                <mat-option value="1">1 - Barreira LEVE</mat-option>
                                <mat-option value="2">2 - Barreira MODERADA</mat-option>
                                <mat-option value="3">3 - Barreira GRAVE</mat-option>
                                <mat-option value="4">4 - Barreira COMPLETA</mat-option>
                                <mat-option value="8">8 - Não especificado</mat-option>
                                <mat-option value="+8">+8 - Facilitador não especificado</mat-option>
                                <mat-option value="9">9 - Não aplicável</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <div fxLayoutAlign="start" class="general-grade" formArrayName="infoSource">
                        <span class="bold-font grade grade-radio">Fonte da informação</span>
                        <mat-radio-group [formControlName]="environmentalFactors.indexOf(factor)" class="grade-radio"
                            aria-label="Select an option">
                            <mat-radio-button color="warn" value="Anamnese">Anamnese</mat-radio-button>
                            <mat-radio-button color="warn" value="Questionário relatado pelo paciente">Questionário
                                relatado pelo paciente</mat-radio-button>
                            <mat-radio-button color="warn" value="Exame clínico">Exame clínico</mat-radio-button>
                            <mat-radio-button color="warn" value="Investigação técnica">Investigação técnica
                            </mat-radio-button>
                        </mat-radio-group>

                        <mat-form-field class="grade-select">
                            <mat-label>
                                Fonte da informação
                            </mat-label>
                            <mat-select [formControlName]="environmentalFactors.indexOf(factor)" class="grade-select">
                                <mat-option color="warn" value="Anamnese">Anamnese</mat-option>
                                <mat-option color="warn" value="Questionário relatado pelo paciente">Questionário
                                    relatado pelo paciente</mat-option>
                                <mat-option color="warn" value="Exame clínico">Exame clínico</mat-option>
                                <mat-option color="warn" value="Investigação técnica">Investigação técnica</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <mat-form-field class="textarea" appearance="fill" formArrayName="problemDescription">
                        <mat-label>Descrição do Problema (Opcional)</mat-label>
                        <textarea matInput cols="100000" [formControlName]="environmentalFactors.indexOf(factor)"
                            placeholder="Descrição do Problema"></textarea>
                    </mat-form-field>

                </mat-expansion-panel>
            </mat-accordion>
            <span #invalid fxLayoutAlign="center" *ngIf="invalids.length > 0" class="invalid">*As questões: {{invalids}}
                devem ser respondidas</span>
            <div class="nextStep">
                <button mat-button mat-button matStepperPrevious mat-stroked-button color="warn"
                    class="btn-block btn-cancel">
                    Anterior
                </button>
                <span class="spacer"></span>
                <button mat-button mat-stroked-button [matTooltip]="invalids"
                    (click)="validateForm(efFormGroup,environmentalFactors)" matTooltipPosition="before"
                    *ngIf="!efFormGroup.valid" color="warn" class="btn-block btn-next">
                    Próximo
                </button>
                <button mat-button matStepperNext mat-stroked-button (click)="addAnswers(efFormGroup)"
                    *ngIf="efFormGroup.valid" color="warn" class="btn-block btn-next">
                    Próximo
                </button>
            </div>
        </form>
    </mat-step>
    <mat-step>
        <ng-template matStepLabel>Revisão</ng-template>
        <div class="mb-5 flex" *ngIf="!loading">
            <button mat-button mat-stroked-button matStepperPrevious color="warn" class="mx-auto">Voltar</button>
            <button mat-button mat-stroked-button (click)="newEvaluation()" color="warn" class="mx-auto">Salvar</button>
            <button mat-button mat-stroked-button (click)="download()" color="warn" class="mx-auto">Baixar</button>
        </div>
        <div *ngIf="loading" fxLayoutAlign="center">
            <mat-spinner></mat-spinner>
        </div>
        <div id="print" #print>
            <h1 class="header-title display-5">Relatório de Classificação Funcional</h1>
            <hr>
            <div class="first-header">
                <p><span class="bold-font">Paciente: </span>{{firstName}} {{lastName}}</p>
                <p><span class="bold-font">Profissional: </span>{{ therapistData.firstName }}
                    {{ therapistData.lastName }}</p>
                <p><span class="bold-font">Local: </span>{{ evaluation.location }}</p>
                <p><span class="bold-font">Data: </span> {{ dateConversion(evaluation.date) }} </p>
            </div>

            <hr>

            <h4 matTooltip="{{stepFive}} ">{{stepFive}}</h4>
            <table *ngFor="let question of bodyFunctions">
                <tr *ngIf="getAnswerGrade(question) !=undefined">
                    <th>codigo</th>
                    <th class="expanded-cell">descrição</th>
                    <th class="bar-teste">0</th>
                    <th class="bar-teste">1</th>
                    <th class="bar-teste">2</th>
                    <th class="bar-teste">3</th>
                    <th class="bar-teste">4</th>
                    <th class="bar-teste">8</th>
                    <th class="bar-teste">9</th>
                </tr>
                <tr *ngIf="getAnswerGrade(question) !=undefined">
                    <th>{{ question.code }}.<span class="colored-font">{{getAnswerGrade(question).generalGrade}}</span></th>
                    <th>{{ question.title }}</th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).generalGrade,0) && lessThan(getAnswerGrade(question).generalGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).generalGrade,1) && lessThan(getAnswerGrade(question).generalGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).generalGrade,2) && lessThan(getAnswerGrade(question).generalGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).generalGrade,3) && lessThan(getAnswerGrade(question).generalGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).generalGrade,4) && lessThan(getAnswerGrade(question).generalGrade,4)' class="colored-bar"></th>
                    <th *ngIf='getAnswerGrade(question).generalGrade == "8" || getAnswerGrade(question).generalGrade == "9"'></th>
                    <th *ngIf='getAnswerGrade(question).generalGrade == "8" || getAnswerGrade(question).generalGrade == "9"'></th>
                    <th *ngIf='getAnswerGrade(question).generalGrade == "8" || getAnswerGrade(question).generalGrade == "9"'></th>
                    <th *ngIf='getAnswerGrade(question).generalGrade == "8" || getAnswerGrade(question).generalGrade == "9"'></th>
                    <th *ngIf='getAnswerGrade(question).generalGrade == "8" || getAnswerGrade(question).generalGrade == "9"'></th>
                    <th *ngIf='getAnswerGrade(question).generalGrade == "9"'></th>
                    <th *ngIf='getAnswerGrade(question).generalGrade == "8"' class="colored-bar"></th>
                    <th *ngIf='getAnswerGrade(question).generalGrade == "9"' class="colored-bar"></th>
                </tr>
            </table>
           
            <hr>
            <h4 matTooltip="{{stepFour}} ">{{stepFour}}</h4>
            <table *ngFor="let question of bodyStructures">
                <tr *ngIf="getAnswerGrade(question) !=undefined">
                    <th>codigo</th>
                    <th class="expanded-cell">descrição</th>
                    <th class="bar-teste">0</th>
                    <th class="bar-teste">1</th>
                    <th class="bar-teste">2</th>
                    <th class="bar-teste">3</th>
                    <th class="bar-teste">4</th>
                    <th class="bar-teste">5</th>
                    <th class="bar-teste">6</th>
                    <th class="bar-teste">7</th>
                    <th class="bar-teste">8</th>
                    <th class="bar-teste">9</th>
                </tr>
                <tr *ngIf="getAnswerGrade(question) !=undefined">
                    <th>{{ question.code }}.<span class="colored-font">{{ getAnswerGrade(question).locationGrade }}{{ getAnswerGrade(question).natureGrade }}{{ getAnswerGrade(question).extensionGrade }}</span></th>
                    <th>{{ question.title }}</th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).locationGrade,0) && lessThan(getAnswerGrade(question).locationGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).locationGrade,1) && lessThan(getAnswerGrade(question).locationGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).locationGrade,2) && lessThan(getAnswerGrade(question).locationGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).locationGrade,3) && lessThan(getAnswerGrade(question).locationGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).locationGrade,4) && lessThan(getAnswerGrade(question).locationGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).locationGrade,5) && lessThan(getAnswerGrade(question).locationGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).locationGrade,6) && lessThan(getAnswerGrade(question).locationGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).locationGrade,7) && lessThan(getAnswerGrade(question).locationGrade,7)' class="colored-bar"></th>
                    <th *ngIf='getAnswerGrade(question).locationGrade == 8 || getAnswerGrade(question).locationGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).locationGrade == 8 || getAnswerGrade(question).locationGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).locationGrade == 8 || getAnswerGrade(question).locationGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).locationGrade == 8 || getAnswerGrade(question).locationGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).locationGrade == 8 || getAnswerGrade(question).locationGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).locationGrade == 8 || getAnswerGrade(question).locationGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).locationGrade == 8 || getAnswerGrade(question).locationGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).locationGrade == 8 || getAnswerGrade(question).locationGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).locationGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).locationGrade == 8' class="colored-bar"></th>
                    <th *ngIf='getAnswerGrade(question).locationGrade == 9' class="colored-bar"></th>
                </tr>
                <tr *ngIf="getAnswerGrade(question) !=undefined">
                    <th class="expand" colspan="2"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).natureGrade,0) && lessThan(getAnswerGrade(question).natureGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).natureGrade,1) && lessThan(getAnswerGrade(question).natureGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).natureGrade,2) && lessThan(getAnswerGrade(question).natureGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).natureGrade,3) && lessThan(getAnswerGrade(question).natureGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).natureGrade,4) && lessThan(getAnswerGrade(question).natureGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).natureGrade,5) && lessThan(getAnswerGrade(question).natureGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).natureGrade,6) && lessThan(getAnswerGrade(question).natureGrade,7)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).natureGrade,7) && lessThan(getAnswerGrade(question).natureGrade,7)' class="colored-bar"></th>
                    <th *ngIf='getAnswerGrade(question).natureGrade == 8 || getAnswerGrade(question).natureGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).natureGrade == 8 || getAnswerGrade(question).natureGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).natureGrade == 8 || getAnswerGrade(question).natureGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).natureGrade == 8 || getAnswerGrade(question).natureGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).natureGrade == 8 || getAnswerGrade(question).natureGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).natureGrade == 8 || getAnswerGrade(question).natureGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).natureGrade == 8 || getAnswerGrade(question).natureGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).natureGrade == 8 || getAnswerGrade(question).natureGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).natureGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).natureGrade == 8' class="colored-bar"></th>
                    <th *ngIf='getAnswerGrade(question).natureGrade == 9' class="colored-bar"></th>
                </tr>
                <tr *ngIf="getAnswerGrade(question) !=undefined">
                    <th class="expand" colspan="2"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).extensionGrade,0) && lessThan(getAnswerGrade(question).extensionGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).extensionGrade,1) && lessThan(getAnswerGrade(question).extensionGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).extensionGrade,2) && lessThan(getAnswerGrade(question).extensionGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).extensionGrade,3) && lessThan(getAnswerGrade(question).extensionGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).extensionGrade,4) && lessThan(getAnswerGrade(question).extensionGrade,4)' class="colored-bar"></th>
                    <th *ngIf='getAnswerGrade(question).extensionGrade == 8 || getAnswerGrade(question).extensionGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).extensionGrade == 8 || getAnswerGrade(question).extensionGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).extensionGrade == 8 || getAnswerGrade(question).extensionGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).extensionGrade == 8 || getAnswerGrade(question).extensionGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).extensionGrade == 8 || getAnswerGrade(question).extensionGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).extensionGrade == 8 || getAnswerGrade(question).extensionGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).extensionGrade == 8 || getAnswerGrade(question).extensionGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).extensionGrade == 8 || getAnswerGrade(question).extensionGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).extensionGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).extensionGrade == 8' class="colored-bar"></th>
                    <th *ngIf='getAnswerGrade(question).extensionGrade == 9' class="colored-bar"></th>
                </tr>
            </table>

            <hr>

            <h4 matTooltip="{{stepThree}} ">{{stepThree}}</h4>
            <table *ngFor="let question of activityAndParticipation">
                <tr *ngIf="getAnswerGrade(question) !=undefined">
                    <th>codigo</th>
                    <th class="expanded-cell">descrição</th>
                    <th class="bar-teste">0</th>
                    <th class="bar-teste">1</th>
                    <th class="bar-teste">2</th>
                    <th class="bar-teste">3</th>
                    <th class="bar-teste">4</th>
                    <th class="bar-teste">8</th>
                    <th class="bar-teste">9</th>
                </tr>
                <tr *ngIf="getAnswerGrade(question) !=undefined">
                    <th>{{ question.code }}.<span class="colored-font">{{ getAnswerGrade(question).capacityGrade }}{{ getAnswerGrade(question).performanceGrade }}</span></th>
                    <th>{{ question.title }}</th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).capacityGrade,0) && lessThan(getAnswerGrade(question).capacityGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).capacityGrade,1) && lessThan(getAnswerGrade(question).capacityGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).capacityGrade,2) && lessThan(getAnswerGrade(question).capacityGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).capacityGrade,3) && lessThan(getAnswerGrade(question).capacityGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).capacityGrade,4) && lessThan(getAnswerGrade(question).capacityGrade,4)' class="colored-bar"></th>
                    <th *ngIf='getAnswerGrade(question).capacityGrade == 8 || getAnswerGrade(question).capacityGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).capacityGrade == 8 || getAnswerGrade(question).capacityGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).capacityGrade == 8 || getAnswerGrade(question).capacityGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).capacityGrade == 8 || getAnswerGrade(question).capacityGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).capacityGrade == 8 || getAnswerGrade(question).capacityGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).capacityGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).capacityGrade == 8' class="colored-bar"></th>
                    <th *ngIf='getAnswerGrade(question).capacityGrade == 9' class="colored-bar"></th>
                </tr>
                <tr *ngIf="getAnswerGrade(question) !=undefined">
                    <th class="expand" colspan="2"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).performanceGrade,0) && lessThan(getAnswerGrade(question).performanceGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).performanceGrade,1) && lessThan(getAnswerGrade(question).performanceGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).performanceGrade,2) && lessThan(getAnswerGrade(question).performanceGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).performanceGrade,3) && lessThan(getAnswerGrade(question).performanceGrade,4)' class="colored-bar"></th>
                    <th *ngIf='gratherThan(getAnswerGrade(question).performanceGrade,4) && lessThan(getAnswerGrade(question).performanceGrade,4)' class="colored-bar"></th>
                    <th *ngIf='getAnswerGrade(question).performanceGrade == 8 || getAnswerGrade(question).performanceGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).performanceGrade == 8 || getAnswerGrade(question).performanceGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).performanceGrade == 8 || getAnswerGrade(question).performanceGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).performanceGrade == 8 || getAnswerGrade(question).performanceGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).performanceGrade == 8 || getAnswerGrade(question).performanceGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).performanceGrade == 9'></th>
                    <th *ngIf='getAnswerGrade(question).performanceGrade == 8' class="colored-bar"></th>
                    <th *ngIf='getAnswerGrade(question).performanceGrade == 9' class="colored-bar"></th>
                </tr>
            </table>

            <hr>

            <h4 matTooltip="{{stepTwo}}">{{stepTwo}}</h4>

            <table *ngFor="let question of environmentalFactors">
                <tr *ngIf="getAnswerGrade(question) !=undefined">
                    <th>codigo</th>
                    <th class="expanded-cell">descrição</th>
                    <th class="bar-teste">+4</th>
                    <th class="bar-teste">+3</th>
                    <th class="bar-teste">+2</th>
                    <th class="bar-teste">+1</th>
                    <th class="bar-teste">0</th>
                    <th class="bar-teste">1</th>
                    <th class="bar-teste">2</th>
                    <th class="bar-teste">3</th>
                    <th class="bar-teste">4</th>
                    <th class="bar-teste">8</th>
                    <th class="bar-teste">+8</th>
                    <th class="bar-teste">9</th>
                </tr>
                <tr *ngIf="getAnswerGrade(question) !=undefined">
                    <th>{{ question.code }}.<span class="colored-font">{{ getAnswerGrade(question).generalGrade }}</span></th>
                    <th>{{ question.title }}</th>
                    <th [ngClass]='{"colored-bar-light":gratherThan(getAnswerGrade(question).generalGrade,"+4") && lessThan(getAnswerGrade(question).generalGrade,"+4")}'></th>
                    <th [ngClass]='{"colored-bar-light":gratherThan(getAnswerGrade(question).generalGrade,"+3") && lessThan(getAnswerGrade(question).generalGrade,"+4")}'></th>
                    <th [ngClass]='{"colored-bar-light":gratherThan(getAnswerGrade(question).generalGrade,"+2") && lessThan(getAnswerGrade(question).generalGrade,"+4")}'></th>
                    <th [ngClass]='{"colored-bar-light":gratherThan(getAnswerGrade(question).generalGrade,"+1") && lessThan(getAnswerGrade(question).generalGrade,"+4")}'></th>
                    <th [ngClass]='{"colored-bar":gratherThan(getAnswerGrade(question).generalGrade,"0") && lessThan(getAnswerGrade(question).generalGrade,4), "colored-bar-light":lessThan(getAnswerGrade(question).generalGrade,"0") && lessThan(getAnswerGrade(question).generalGrade,"+4")}'></th>
                    <th [ngClass]='{"colored-bar":gratherThan(getAnswerGrade(question).generalGrade,1) && lessThan(getAnswerGrade(question).generalGrade,4)}'></th>
                    <th [ngClass]='{"colored-bar":gratherThan(getAnswerGrade(question).generalGrade,2) && lessThan(getAnswerGrade(question).generalGrade,4)}'></th>
                    <th [ngClass]='{"colored-bar":gratherThan(getAnswerGrade(question).generalGrade,3) && lessThan(getAnswerGrade(question).generalGrade,4)}'></th>
                    <th [ngClass]='{"colored-bar":gratherThan(getAnswerGrade(question).generalGrade,4) && lessThan(getAnswerGrade(question).generalGrade,4)}'></th>
                    <th [ngClass]='{"colored-bar":getAnswerGrade(question).generalGrade == "8"}'></th>
                    <th [ngClass]='{"colored-bar-light":getAnswerGrade(question).generalGrade == "+8"}'></th>
                    <th [ngClass]='{"colored-bar":getAnswerGrade(question).generalGrade == "9"}'></th>
                </tr>
            </table>

            <div id="rectangle"> </div>
            <p style="text-align: center; font-weight: bold;"> Assinatura e carimbo do profissional </p>
            <p style="text-align: center;"> {{ therapistData.firstName }} {{ therapistData.lastName }} </p>
            <p style="text-align: center;"> {{regionalID}} - {{therapistData.professionalData.professionalID}} </p>
        </div>
    </mat-step>
</mat-horizontal-stepper>